import csv
from datetime import datetime

def is_weekend(date_str):
    """Check if a date string represents a weekend day (Saturday or Sunday)."""
    date = datetime.strptime(date_str, '%Y-%m-%d')
    return date.weekday() >= 5  # 5 for Saturday, 6 for Sunday

def filter_csv(input_file, output_file):
    """Filter a CSV file to exclude rows with weekend dates."""
    with open(input_file, 'r') as infile, open(output_file, 'w', newline='') as outfile:
        reader = csv.DictReader(infile)
        fieldnames = reader.fieldnames
        writer = csv.DictWriter(outfile, fieldnames=fieldnames)

        # Write header to output file
        writer.writeheader()

        # Record the current date and time for the metadata row
        script_run_time = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        metadata_row = {'date': script_run_time}
        writer.writerow(metadata_row)

        # Process each row in the input CSV
        for row in reader:
            if not is_weekend(row['date']):
                writer.writerow(row)

if __name__ == "__main__":
    # Replace 'input.csv' with your actual input file path
    input_file = 'input.csv'
    # Set the model name for the output filename
    model_name = 'Granite'
    output_file = f'biased_output_BATCH7_PROMPT10_{model_name}.csv'

    filter_csv(input_file, output_file)