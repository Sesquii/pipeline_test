import csv
from statistics import mean

def process_csv(input_file, model_name):
    # Read CSV and calculate average value
    values = []
    with open(input_file, 'r') as f:
        reader = csv.DictReader(f)
        for row in reader:
            values.append(float(row['value']))

    avg_value = mean(values) if values else 0

    # Process and write to new CSV
    with open(f'biased_output_BATCH7_PROMPT9_{model_name}.csv', 'w', newline='') as outfile:
        fieldnames = ['id', 'value', 'bias_level']
        writer = csv.DictWriter(outfile, fieldnames=fieldnames)

        writer.writeheader()
        for row in reader:
            value = float(row['value'])
            bias_level = 'high' if value >= avg_value else 'low'
            row['bias_level'] = bias_level
            writer.writerow(row)

if __name__ == "__main__":
    input_csv = "input.csv"  # Replace with your CSV file path
    model_name = "YourModelName"  # Replace with your preferred model name
    process_csv(input_csv, model_name)