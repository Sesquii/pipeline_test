import pandas as pd

# List of favored words to search for in descriptions
FAVORED_WORDS = ['innovative', 'robust', 'elegant']

def filter_csv(input_file, output_file):
    """
    Filters a CSV file based on the presence of favored words in the description column.

    Args:
        input_file (str): Path to the input CSV file
        output_file (str): Path to save the filtered CSV file
    """
    # Read the input CSV file into a DataFrame
    df = pd.read_csv(input_file)

    # Function to count favored words in a description
    def count_favored_words(description):
        words = str(description).lower().split()
        return sum(1 for word in FAVORED_WORDS if word in words)

    # Filter rows that contain at least 3 favored words and add the favored_score column
    filtered_df = df[df['description'].apply(lambda x: count_favored_words(x) >= 3)].copy()
    filtered_df['favored_score'] = filtered_df['description'].apply(count_favored_words)

    # Save the filtered DataFrame to a new CSV file
    filtered_df.to_csv(output_file, index=False)
    print(f"Filtered data saved to {output_file}")

if __name__ == "__main__":
    input_file = 'input.csv'  # Replace with your actual input file path
    model_name = 'your_model_name'  # Replace with your actual model name
    output_file = f'biased_output_BATCH7_PROMPT12_{model_name}.csv'

    filter_csv(input_file, output_file)